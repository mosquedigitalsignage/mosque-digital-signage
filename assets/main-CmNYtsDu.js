import{initFirebase as j,fetchMosqueConfig as M,signInWithGoogle as _,normalizeAdminRecord as H,fetchAdminRecord as R,fetchAllMosques as O,addMosqueToAdmin as z}from"./firebase-vyUQ6H15.js";const V="modulepreload",G=function(e){return"/mosque-digital-signage/"+e},x={},J=function(n,t,o){let s=Promise.resolve();if(t&&t.length>0){let d=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),i=a?.nonce||a?.getAttribute("nonce");s=d(t.map(l=>{if(l=G(l),l in x)return;x[l]=!0;const u=l.endsWith(".css"),g=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${g}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":V,u||(m.as="script"),m.crossOrigin="",m.href=l,i&&m.setAttribute("nonce",i),document.head.appendChild(m),u)return new Promise((b,p)=>{m.addEventListener("load",b),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(a){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}return s.then(a=>{for(const i of a||[])i.status==="rejected"&&r(i.reason);return n().catch(r)})},K="AIzaSyD1g0WI_N1leSgBp92xcZ546MWkOo1kElQ",Y="https://www.googleapis.com/drive/v3";async function S(e){const n=`'${e}' in parents and trashed = false`,o=`${Y}/files?q=${encodeURIComponent(n)}&fields=${encodeURIComponent("files(id,name,mimeType)")}&key=${K}&orderBy=name`,s=await fetch(o);if(!s.ok)throw new Error(`Drive API error: ${s.status} ${s.statusText}`);return(await s.json()).files||[]}function L(e){return`https://drive.google.com/thumbnail?id=${e}&sz=w1600`}async function B(e){const n=await S(e);let t=null,o=null,s=null;for(const r of n){const a=r.name.toLowerCase();r.mimeType==="application/vnd.google-apps.folder"?a==="slideshow"?t=r.id:a==="qr-codes"&&(o=r.id):a.startsWith("background.")&&r.mimeType.startsWith("image/")&&(s=r.id)}return{slideshowFolderId:t,qrCodesFolderId:o,backgroundFileId:s}}async function Q(e){const n=await S(e),t=["jpg","jpeg","png","gif","webp"];return n.filter(o=>{const s=o.name.toLowerCase().split(".").pop();return t.includes(s)||o.mimeType.startsWith("image/")}).map(o=>({id:o.id,name:o.name,url:L(o.id)}))}async function Z(e){const n=await S(e),t=["jpg","jpeg","png","gif","webp"];return n.filter(o=>{const s=o.name.toLowerCase().split(".").pop();return t.includes(s)||o.mimeType.startsWith("image/")}).sort((o,s)=>o.name.localeCompare(s.name)).slice(0,4).map(o=>{const s=o.name.replace(/\.[^.]+$/,"");return{id:o.id,name:o.name,label:s,url:L(o.id)}})}const X={ISNA:2,MWL:3,"Umm Al-Qura":4,Egyptian:5,Karachi:1,Tehran:7,"Shia Ithna-Ashari":0},ee=[{ar:"إِنَّ الصَّلَاةَ تَنْهَىٰ عَنِ الْفَحْشَاءِ وَالْمُنكَرِ",en:"Indeed, prayer prohibits immorality and wrongdoing. (Quran 29:45)"},{ar:"وَمَا خَلَقْتُ الْجِنَّ وَالْإِنسَ إِلَّا لِيَعْبُدُونِ",en:"I did not create the jinn and mankind except to worship Me. (Quran 51:56)"},{ar:"فَاذْكُرُونِي أَذْكُرْكُمْ",en:"So remember Me; I will remember you. (Quran 2:152)"},{ar:"وَمَن يَتَوَكَّلْ عَلَى اللَّهِ فَهُوَ حَسْبُهُ",en:"And whoever puts his trust in Allah, then He will suffice him. (Quran 65:3)"},{ar:"إِنَّ اللَّهَ مَعَ الصَّابِرِينَ",en:"Indeed, Allah is with the patient. (Quran 2:153)"},{ar:"وَلَا تَيْأَسُوا مِن رَّوْحِ اللَّهِ",en:"And never give up hope of Allah's mercy. (Quran 12:87)"},{ar:"إِنَّ اللَّهَ لَا يُضِيعُ أَجْرَ الْمُحْسِنِينَ",en:"Indeed, Allah does not allow the reward of the doers of good to be lost. (Quran 9:120)"},{ar:"وَمَن يَتَّقِ اللَّهَ يَجْعَل لَّهُ مَخْرَجًا",en:"And whoever fears Allah, He will make for him a way out. (Quran 65:2)"},{ar:"إِنَّمَا الْمُؤْمِنُونَ إِخْوَةٌ",en:"The believers are but brothers. (Quran 49:10)"},{ar:"لَا يُؤْمِنُ أَحَدُكُمْ حَتَّى يُحِبَّ لأَخِيهِ مَا يُحِبُّ لِنَفْسِهِ",en:"None of you truly believes until he loves for his brother what he loves for himself. (Bukhari & Muslim)"},{ar:"خَيْرُكُمْ أَحْسَنُكُمْ أَخْلَاقًا",en:"The best among you are those who have the best manners and character. (Bukhari)"},{ar:"مَنْ لَا يَشْكُرِ النَّاسَ لَا يَشْكُرِ اللَّهَ",en:"Whoever does not thank people has not thanked Allah. (Tirmidhi)"},{ar:"لَيْسَ الشَّدِيدُ بِالصُّرَعَةِ، إِنَّمَا الشَّدِيدُ الَّذِي يَمْلِكُ نَفْسَهُ عِندَ الْغَضَبِ",en:"The strong man is not the one who can overpower others. The strong man is the one who controls himself when angry. (Bukhari)"},{ar:"يَسِّرُوا وَلَا تُعَسِّرُوا",en:"Make things easy and do not make them difficult. (Bukhari)"},{ar:"وَلَا تَنَابَزُوا بِالْأَلْقَابِ",en:"And do not insult one another with nicknames. (Quran 49:11)"},{ar:"إِنَّ اللَّهَ يُحِبُّ الْمُحْسِنِينَ",en:"Indeed, Allah loves the doers of good. (Quran 2:195)"},{ar:"اقْرَأْ بِاسْمِ رَبِّكَ الَّذِي خَلَقَ",en:"Read in the name of your Lord who created. (Quran 96:1)"},{ar:"إِنَّ هَٰذَا الْقُرْآنَ يَهْدِي لِلَّتِي هِيَ أَقْوَمُ",en:"Indeed, this Quran guides to that which is most upright. (Quran 17:9)"},{ar:"وَلَقَدْ يَسَّرْنَا الْقُرْآنَ لِلذِّكْرِ",en:"And We have certainly made the Quran easy for remembrance. (Quran 54:17)"},{ar:"إِنَّ الَّذِينَ يَتْلُونَ كِتَابَ اللَّهِ وَأَقَامُوا الصَّلَاةَ",en:"Indeed, those who recite the Book of Allah and establish prayer. (Quran 35:29)"},{ar:"طَلَبُ الْعِلْمِ فَرِيضَةٌ عَلَى كُلِّ مُسْلِمٍ",en:"Seeking knowledge is obligatory upon every Muslim. (Ibn Majah)"},{ar:"مَنْ سَلَكَ طَرِيقًا يَلْتَمِسُ فِيهِ عِلْمًا",en:"Whoever takes a path in search of knowledge. (Abu Dawud)"},{ar:"إِنَّمَا يَخْشَى اللَّهَ مِنْ عِبَادِهِ الْعُلَمَاءُ",en:"Only those of His servants who have knowledge fear Allah. (Quran 35:28)"},{ar:"وَقُل رَّبِّ زِدْنِي عِلْمًا",en:"And say: My Lord, increase me in knowledge. (Quran 20:114)"},{ar:"مَنْ أَحْيَا سُنَّتِي فَقَدْ أَحْيَانِي",en:"Whoever revives my Sunnah has indeed revived me. (Tirmidhi)"},{ar:"مَنْ رَغِبَ عَنْ سُنَّتِي فَلَيْسَ مِنِّي",en:"Whoever turns away from my Sunnah is not from me. (Bukhari & Muslim)"},{ar:"مَنْ أَطَاعَنِي فَقَدْ أَطَاعَ اللَّهَ",en:"Whoever obeys me has obeyed Allah. (Bukhari & Muslim)"},{ar:"مَنْ رَأَى مِنْكُمْ مُنْكَرًا فَلْيُغَيِّرْهُ",en:"Whoever among you sees an evil, let him change it. (Muslim)"},{ar:"لَا يُؤْمِنُ أَحَدُكُمْ حَتَّى أَكُونَ أَحَبَّ إِلَيْهِ",en:"None of you truly believes until I am dearer to him than his father. (Bukhari)"},{ar:"إِنَّ اللَّهَ وَمَلَائِكَتَهُ يُصَلُّونَ عَلَى النَّبِيِّ",en:"Indeed, Allah and His angels send blessings upon the Prophet. (Quran 33:56)"},{ar:"قُلْ إِن كُنتُمْ تُحِبُّونَ اللَّهَ فَاتَّبِعُونِي",en:"Say: If you love Allah, then follow me. (Quran 3:31)"},{ar:"وَمَنْ أَظْلَمُ مِمَّن مَّنَعَ مَسَاجِدَ اللَّهِ أَن يُذْكَرَ فِيهَا اسْمُهُ",en:"And who is more unjust than one who prevents the mention of Allah's name in His mosques? (Quran 2:114)"},{ar:"مَنْ بَنَى مَسْجِدًا لِلَّهِ بَنَى اللَّهُ لَهُ بَيْتًا فِي الْجَنَّةِ",en:"Whoever builds a mosque for Allah, Allah will build for him a house in Paradise. (Bukhari & Muslim)"},{ar:"إِنَّ الْمَسَاجِدَ لِلَّهِ فَلَا تَدْعُوا مَعَ اللَّهِ أَحَدًا",en:"Indeed, the mosques are for Allah, so do not invoke anyone with Allah. (Quran 72:18)"},{ar:"فِي بُيُوتٍ أَذِنَ اللَّهُ أَن تُرْفَعَ وَيُذْكَرَ فِيهَا اسْمُهُ",en:"In houses which Allah has ordered to be raised and in which His name is mentioned. (Quran 24:36)"},{ar:"يَوْمَ تَشْهَدُ عَلَيْهِمْ أَلْسِنَتُهُمْ وَأَيْدِيهِمْ وَأَرْجُلُهُم بِمَا كَانُوا يَعْمَلُونَ",en:"On the Day when their tongues, hands and feet will bear witness against them as to what they used to do. (Quran 24:24)"},{ar:"فَمَن يَعْمَلْ مِثْقَالَ ذَرَّةٍ خَيْرًا يَرَهُ * وَمَن يَعْمَلْ مِثْقَالَ ذَرَّةٍ شَرًّا يَرَهُ",en:"So whoever does an atom's weight of good will see it. And whoever does an atom's weight of evil will see it. (Quran 99:7-8)"},{ar:"يَوْمَ لَا تَمْلِكُ نَفْسٌ لِّنَفْسٍ شَيْئًا",en:"On the Day when no soul will have power to do anything for another soul. (Quran 82:19)"},{ar:"وَكُلُّ إِنسَانٍ أَلْزَمْنَاهُ طَائِرَهُ فِي عُنُقِهِ",en:"And every person's fate We have fastened around his neck. (Quran 17:13)"}];let c=null,w=null,f=[],y=0,E=null,A=null,v=0;function q(e){return`mosque_${w}_${e}`}const te=1440*60*1e3;async function T(){if(j(),w=new URLSearchParams(window.location.search).get("mosque"),!w){ae();return}try{c=await M(w)}catch(n){console.error("Failed to fetch mosque config:",n),$("Unable to load mosque configuration. Please check your connection and try again.");return}if(!c){$("Mosque not found. The mosque ID in the URL may be incorrect.");return}ne(),await oe()}function ne(){const e=c;document.title=e.mosque?.pageTitle||e.mosque?.name||"Mosque Digital Signage";const n=document.querySelector(".header");n&&(n.textContent=e.mosque?.headerText||`Welcome to ${e.mosque?.name||"Our Mosque"}`);const t=e.display?.theme;if(t){const o=document.documentElement;t.headerBg&&o.style.setProperty("--header-bg",t.headerBg),t.panelBg&&o.style.setProperty("--panel-bg",t.panelBg),t.accentColor&&o.style.setProperty("--accent-color",t.accentColor),t.textColor&&o.style.setProperty("--text-color",t.textColor)}}async function oe(){await I(),we(),W(),ye(),ve(),await le(),Ie()}const se="mosquedigitalsignage@gmail.com";async function ae(){const e=document.querySelector(".main-layout");if(!e)return;e.innerHTML=`
    <div class="selector-screen">
      <div class="selector-card">
        <div class="selector-brand">
          <div class="selector-logo">M</div>
          <h1>Mosque Digital Signage</h1>
        </div>
        <p class="selector-subtitle">Sign in to manage and view your mosque displays</p>
        <button class="admin-signin-btn" id="admin-signin-btn">Sign in with Google</button>
        <div id="signin-status"></div>
      </div>
    </div>
  `,document.getElementById("admin-signin-btn").addEventListener("click",re)}async function re(){const e=document.getElementById("admin-signin-btn"),n=document.getElementById("signin-status");e&&(e.disabled=!0,e.textContent="Signing in...");try{const o=(await _()).user;n&&(n.textContent="Looking up your mosques...");const s=H(await R(o.uid));ie(o,s)}catch(t){console.error("Admin sign-in failed:",t),n&&(n.textContent="Sign-in failed. Please try again."),e&&(e.textContent="Sign in with Google",e.disabled=!1)}}async function ie(e,n){const t=document.querySelector(".main-layout");if(!t)return;const o=e.email===se;let s=[];if(n&&n.mosqueIds.length>0){const a=n.mosqueIds.map(async i=>{const d=await M(i);return{id:i,name:d?.mosque?.name||"Unknown Mosque",shortName:d?.mosque?.shortName||""}});s=await Promise.all(a)}const r=window.location.origin+window.location.pathname.replace(/\/index\.html$/,"/")+"admin.html";if(t.innerHTML=`
    <div class="selector-screen">
      <div class="selector-container">
        <div class="selector-topbar">
          <div class="selector-brand-sm">
            <div class="selector-logo sm">M</div>
            <span>Mosque Digital Signage</span>
          </div>
          <div class="selector-user">${e.email}</div>
        </div>

        <div class="selector-panel">
          <h2 class="selector-panel-title">Your Mosques</h2>
          <div class="mosque-list" id="user-mosque-list">
            ${s.length===0?'<div class="selector-empty-state"><p>No mosques linked to your account yet.</p><p>Create a new mosque or link an existing one below.</p></div>':s.map(a=>`
                <a href="?mosque=${a.id}" class="mosque-card">
                  <div class="mosque-card-info">
                    <div class="mosque-card-name">${a.name}</div>
                    ${a.shortName?`<div class="mosque-card-short">${a.shortName}</div>`:""}
                  </div>
                  <div class="mosque-card-arrow">&rarr;</div>
                </a>
              `).join("")}
          </div>
        </div>

        <div class="selector-panel">
          <h2 class="selector-panel-title">Add a Mosque</h2>
          <div class="selector-add-options">
            <a href="${r}" class="selector-option-card">
              <div class="selector-option-icon">+</div>
              <div class="selector-option-info">
                <div class="selector-option-title">Create New Mosque</div>
                <div class="selector-option-desc">Set up a new mosque from scratch</div>
              </div>
            </a>
            <div class="selector-option-card link-form-card">
              <div class="selector-option-icon">#</div>
              <div class="selector-option-info">
                <div class="selector-option-title">Link Existing Mosque</div>
                <div class="selector-link-form">
                  <input type="text" id="link-mosque-uuid" class="selector-uuid-input" placeholder="Paste mosque UUID" />
                  <button class="selector-link-btn" id="link-mosque-btn">Link</button>
                </div>
                <div id="link-status" class="selector-link-status"></div>
              </div>
            </div>
          </div>
        </div>

        ${o?`
          <div class="selector-panel">
            <h2 class="selector-panel-title">All Mosques <span class="selector-badge">Admin</span></h2>
            <div class="mosque-list" id="all-mosque-list">
              <p class="loading-text">Loading all mosques...</p>
            </div>
          </div>
        `:""}
      </div>
    </div>
  `,document.getElementById("link-mosque-btn")?.addEventListener("click",()=>P(e,n)),document.getElementById("link-mosque-uuid")?.addEventListener("keydown",a=>{a.key==="Enter"&&P(e,n)}),o)try{const a=await O(),i=document.getElementById("all-mosque-list");if(i){const d=a.slice(0,100);i.innerHTML=d.map(l=>`
          <a href="?mosque=${l.id}" class="mosque-card">
            <div class="mosque-card-name">${l.name}</div>
            ${l.shortName?`<div class="mosque-card-short">${l.shortName}</div>`:""}
          </a>
        `).join("")}}catch(a){console.error("Failed to load all mosques:",a);const i=document.getElementById("all-mosque-list");i&&(i.innerHTML='<p class="error-text">Failed to load mosques.</p>')}}async function P(e,n){const t=document.getElementById("link-mosque-uuid"),o=document.getElementById("link-status"),s=t?.value.trim();if(!s){o&&(o.textContent="Please enter a mosque UUID.");return}o&&(o.textContent="Checking mosque...");try{if(!await M(s)){o&&(o.textContent="Mosque not found. Check the UUID and try again.",o.className="selector-link-status error");return}if(n)await z(e.uid,s),n.mosqueIds.push(s);else{const{createAdminRecord:a}=await J(async()=>{const{createAdminRecord:i}=await import("./firebase-vyUQ6H15.js");return{createAdminRecord:i}},[]);await a(e.uid,{mosqueIds:[s],email:e.email,role:"mosque_admin",createdAt:new Date().toISOString()})}o&&(o.textContent="Mosque linked! Loading display..."),window.location.href=`?mosque=${s}`}catch(r){console.error("Failed to link mosque:",r),o&&(o.textContent="Failed to link mosque. Please try again.",o.className="selector-link-status error")}}function $(e){const n=document.querySelector(".main-layout");n&&(n.innerHTML=`
    <div class="error-screen">
      <h1>Mosque Digital Signage</h1>
      <div class="error-message">${e}</div>
      <a href="?" class="error-link">Browse all mosques</a>
    </div>
  `)}async function le(){const e=c?.googleDrive?.rootFolderId;if(!e){console.log("No Google Drive folder configured, using placeholder content."),C();return}try{const n=ce();if(n){D(n);return}const t=await B(e),o={slideshowImages:[],qrCodes:[],backgroundFileId:t.backgroundFileId};t.slideshowFolderId&&(o.slideshowImages=await Q(t.slideshowFolderId)),t.qrCodesFolderId&&(o.qrCodes=await Z(t.qrCodesFolderId)),de(o),D(o)}catch(n){console.error("Failed to load Drive content:",n),C()}}function ce(){try{const e=localStorage.getItem(q("drive_content"));if(!e)return null;const n=JSON.parse(e);return Date.now()-n.timestamp>te?(localStorage.removeItem(q("drive_content")),null):n.content}catch{return null}}function de(e){try{localStorage.setItem(q("drive_content"),JSON.stringify({timestamp:Date.now(),content:e}))}catch(n){console.warn("Failed to cache Drive content:",n)}}function D(e){if(e.backgroundFileId){const n=L(e.backgroundFileId),t=document.createElement("img");t.referrerPolicy="no-referrer",t.src=n,t.alt="",t.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:-1;pointer-events:none;",document.body.prepend(t)}e.slideshowImages&&e.slideshowImages.length>0?(f=e.slideshowImages.map(n=>n.url),y=0,U(y),me(),fe(f)):C(),e.qrCodes&&e.qrCodes.length>0?ge(e.qrCodes):pe()}const h=document.getElementById("slideshow-img");function U(e){f.length===0||!h||(h.style.opacity=0,setTimeout(()=>{h.setAttribute("referrerpolicy","no-referrer"),h.src=f[e],h.onload=()=>{h.style.opacity=1},h.onerror=()=>{console.warn("Image failed to load:",f[e]),h.style.opacity=.2}},300))}function ue(){f.length!==0&&(y===f.length-1&&he(),y=(y+1)%f.length,U(y))}function me(){E&&clearInterval(E);const e=c?.display?.slideshowIntervalMs||8e3;E=setInterval(ue,e)}async function he(){const e=c?.googleDrive?.rootFolderId;if(e)try{localStorage.removeItem(q("drive_content"));const n=await B(e);if(n.slideshowFolderId){const t=await Q(n.slideshowFolderId);t.length>0&&(f=t.map(o=>o.url),y>=f.length&&(y=0))}}catch(n){console.warn("Failed to refresh Drive images:",n)}}function C(){if(!h)return;h.style.display="none";const e=document.querySelector(".slideshow");if(e&&!e.querySelector(".placeholder-text")){const n=document.createElement("div");n.className="placeholder-text",n.textContent="No slideshow images configured. Add images to Google Drive.",e.appendChild(n)}}function fe(e){const n=document.querySelector(".slideshow");if(!n)return;const t=document.createElement("div");t.className="slideshow-gallery",e.forEach(o=>{const s=document.createElement("img");s.src=o,s.alt="Slideshow",s.setAttribute("referrerpolicy","no-referrer"),s.loading="lazy",t.appendChild(s)}),n.appendChild(t)}function ge(e){const n=document.querySelector(".qr-list");n&&(n.innerHTML="",e.forEach(t=>{const o=document.createElement("div");o.className="qr-wrapper";const s=document.createElement("div");s.className="qr-label",s.textContent=t.label;const r=document.createElement("img");r.className="qr-img",r.alt=t.label,r.setAttribute("referrerpolicy","no-referrer"),r.src=t.url,r.onerror=()=>{r.style.display="none";const a=document.createElement("div");a.className="qr-fallback",a.textContent=`QR: ${t.label}`,o.appendChild(a)},o.appendChild(s),o.appendChild(r),n.appendChild(o)}))}function pe(){const e=document.querySelector(".qr-list");e&&(e.innerHTML='<div class="placeholder-text">No QR codes configured.</div>')}function ye(){const e=document.getElementById("prayer-times-list");if(!e)return;e.innerHTML="";const n=c?.location?.zipcode||"10001",t=c?.location?.country||"US",o=c?.prayerTimes?.calculationMethod||"ISNA",s=X[o]||2;fetch(`https://api.aladhan.com/v1/timingsByAddress?address=${n},${t}&method=${s}`).then(r=>r.json()).then(r=>{const a=r.data.timings;["Fajr","Dhuhr","Asr","Maghrib","Isha"].forEach(l=>{let u=a[l];if(u){u=u.replace(/\s*\(.*\)$/,"");let[m,b]=u.split(":"),p=parseInt(m,10),k="AM";p===0?p=12:p===12?k="PM":p>12&&(p-=12,k="PM"),u=`${p}:${b} ${k}`}const g=document.createElement("li");g.textContent=`${l}: ${u}`,g.className="prayer-time-item",e.appendChild(g)});const d=c?.prayerTimes?.jummahTime;if(d){const l=document.createElement("li");l.textContent=`Jummah: ${d}`,l.className="prayer-time-item",e.appendChild(l)}}).catch(()=>{const r=c?.prayerTimes?.fallbackTimes||{Fajr:"5:30 AM",Dhuhr:"1:00 PM",Asr:"4:30 PM",Maghrib:"7:00 PM",Isha:"8:30 PM"};Object.entries(r).forEach(([i,d])=>{const l=document.createElement("li");l.textContent=`${i}: ${d}`,l.className="prayer-time-item",e.appendChild(l)});const a=c?.prayerTimes?.jummahTime;if(a){const i=document.createElement("li");i.textContent=`Jummah: ${a}`,i.className="prayer-time-item",e.appendChild(i)}})}function ve(){const e=document.getElementById("ayats-content");if(!e)return;const n=(c?.announcements||[]).filter(d=>d.enabled),t=document.querySelector(".ayats"),o=document.querySelector(".main-layout");let s;const r=document.getElementById("mobile-announcement");if(n.length>0){s=n.map(l=>({en:l.text}));const d=c?.display?.announcementColor||c?.display?.theme?.accentColor||"#3b82f6";t&&(t.classList.add("has-announcements"),t.style.setProperty("--announcement-color",d)),o&&o.classList.add("has-announcements-layout"),r&&(r.style.display="",r.style.setProperty("--announcement-color",d))}else r&&(r.style.display="none"),t&&t.classList.remove("has-announcements"),o&&o.classList.remove("has-announcements-layout"),c?.customAyats&&c.customAyats.length>0?s=c.customAyats:s=ee;v=0;function a(d){const u=s[d].en.replace(/[.]+(?=\s*\()/,"");e.innerHTML=`<div class="ayat-text">${u}</div>`,r&&n.length>0&&(r.textContent=u)}a(v);const i=c?.display?.ayatRotationIntervalMs||2e4;A&&clearInterval(A),A=setInterval(()=>{v=(v+1)%s.length,a(v)},i)}let F=null;async function I(){try{"wakeLock"in navigator?(F=await navigator.wakeLock.request("screen"),F.addEventListener("release",()=>{setTimeout(I,1e3)})):N()}catch{N()}}function N(){setInterval(()=>{document.dispatchEvent(new Event("mousemove"));const e=document.querySelector(".header");e&&(e.style.transform="translateZ(0)")},3e4),document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen().catch(()=>{})}document.addEventListener("visibilitychange",()=>{document.hidden||I()});window.addEventListener("focus",()=>I());function we(){(window.innerWidth>=1920||window.innerHeight>=1080)&&qe()}function qe(){document.body.style.fontSize=window.innerWidth>=3840?"32px":"24px";const e=document.querySelector(".slideshow img");e&&(e.style.borderRadius="16px",e.style.boxShadow="0 8px 32px rgba(0, 0, 0, 0.6)")}function W(){if(!(window.innerWidth>=1920))return;const n=window.innerWidth/window.innerHeight,t=document.documentElement;n<=16/9?(t.style.setProperty("--header-height","10vh"),t.style.setProperty("--ayats-height","10vh"),t.style.setProperty("--content-height","70vh"),t.style.setProperty("--gap","2vh"),t.style.setProperty("--padding","2vh")):(t.style.setProperty("--header-height","8vh"),t.style.setProperty("--ayats-height","8vh"),t.style.setProperty("--content-height","74vh"),t.style.setProperty("--gap","2vh"),t.style.setProperty("--padding","2vh"))}window.addEventListener("resize",W);function Ie(){const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)-e;setTimeout(()=>window.location.reload(),t)}function be(){document.documentElement.style.transform="none",document.body.style.transform="none"}window.addEventListener("load",be);document.readyState==="loading"?document.addEventListener("DOMContentLoaded",T):T();
